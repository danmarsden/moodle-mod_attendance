define(["jquery"],function(t,e){return{initialise:function(e){var i=Array.prototype.slice,n=Array.prototype.splice,r={topSpacing:0,bottomSpacing:0,className:"is-sticky",wrapperClassName:"sticky-wrapper",center:!1,getWidthFrom:"",widthFromWrapper:!0,responsiveWidth:!1,zIndex:"inherit"},s=t(window),o=t(document),c=[],a=s.height(),p=function(){for(var e=s.scrollTop(),i=o.height(),n=i-a,r=e>n?n-e:0,p=0,d=c.length;p<d;p++){var h=c[p],l=h.stickyWrapper.offset().top-h.topSpacing-r;if(h.stickyWrapper.css("height",h.stickyElement.outerHeight()),e<=l)null!==h.currentTop&&(h.stickyElement.css({width:"",position:"",top:"","z-index":""}),h.stickyElement.parent().removeClass(h.className),h.stickyElement.trigger("sticky-end",[h]),h.currentTop=null);else{var u,g=i-h.stickyElement.outerHeight()-h.topSpacing-h.bottomSpacing-e-r;if(g<0?g+=h.topSpacing:g=h.topSpacing,h.currentTop!==g)h.getWidthFrom?(padding=h.stickyElement.innerWidth()-h.stickyElement.width(),u=t(h.getWidthFrom).width()-padding||null):h.widthFromWrapper&&(u=h.stickyWrapper.width()),null==u&&(u=h.stickyElement.width()),h.stickyElement.css("width",u).css("position","fixed").css("top",g).css("z-index",h.zIndex),h.stickyElement.parent().addClass(h.className),null===h.currentTop?h.stickyElement.trigger("sticky-start",[h]):h.stickyElement.trigger("sticky-update",[h]),h.currentTop===h.topSpacing&&h.currentTop>g||null===h.currentTop&&g<h.topSpacing?h.stickyElement.trigger("sticky-bottom-reached",[h]):null!==h.currentTop&&g===h.topSpacing&&h.currentTop<g&&h.stickyElement.trigger("sticky-bottom-unreached",[h]),h.currentTop=g;var y=h.stickyWrapper.parent();h.stickyElement.offset().top+h.stickyElement.outerHeight()>=y.offset().top+y.outerHeight()&&h.stickyElement.offset().top<=h.topSpacing?h.stickyElement.css("position","absolute").css("top","").css("bottom",0).css("z-index",""):h.stickyElement.css("position","fixed").css("top",g).css("bottom","").css("z-index",h.zIndex)}}},d=function(){a=s.height();for(var e=0,i=c.length;e<i;e++){var n=c[e],r=null;n.getWidthFrom?n.responsiveWidth&&(r=t(n.getWidthFrom).width()):n.widthFromWrapper&&(r=n.stickyWrapper.width()),null!=r&&n.stickyElement.css("width",r)}},h={init:function(e){return this.each(function(){var i=t.extend({},r,e),n=t(this),s=n.attr("id"),o=s?s+"-"+r.wrapperClassName:r.wrapperClassName,a=t("<div></div>").attr("id",o).addClass(i.wrapperClassName);n.wrapAll(function(){if(0==t(this).parent("#"+o).length)return a});var p=n.parent();i.center&&p.css({width:n.outerWidth(),marginLeft:"auto",marginRight:"auto"}),"right"===n.css("float")&&n.css({float:"none"}).parent().css({float:"right"}),i.stickyElement=n,i.stickyWrapper=p,i.currentTop=null,c.push(i),h.setWrapperHeight(this),h.setupChangeListeners(this)})},setWrapperHeight:function(e){var i=t(e),n=i.parent();n&&n.css("height",i.outerHeight())},setupChangeListeners:function(t){window.MutationObserver?new window.MutationObserver(function(e){(e[0].addedNodes.length||e[0].removedNodes.length)&&h.setWrapperHeight(t)}).observe(t,{subtree:!0,childList:!0}):window.addEventListener?(t.addEventListener("DOMNodeInserted",function(){h.setWrapperHeight(t)},!1),t.addEventListener("DOMNodeRemoved",function(){h.setWrapperHeight(t)},!1)):window.attachEvent&&(t.attachEvent("onDOMNodeInserted",function(){h.setWrapperHeight(t)}),t.attachEvent("onDOMNodeRemoved",function(){h.setWrapperHeight(t)}))},update:p,unstick:function(e){return this.each(function(){for(var e=t(this),i=-1,r=c.length;r-- >0;)c[r].stickyElement.get(0)===this&&(n.call(c,r,1),i=r);-1!==i&&(e.unwrap(),e.css({width:"",position:"",top:"",float:"","z-index":""}))})}};window.addEventListener?(window.addEventListener("scroll",p,!1),window.addEventListener("resize",d,!1)):window.attachEvent&&(window.attachEvent("onscroll",p),window.attachEvent("onresize",d)),t.fn.sticky=function(e){return h[e]?h[e].apply(this,i.call(arguments,1)):"object"!=typeof e&&e?void t.error("Method "+e+" does not exist on jQuery.sticky"):h.init.apply(this,arguments)},t.fn.unstick=function(e){return h[e]?h[e].apply(this,i.call(arguments,1)):"object"!=typeof e&&e?void t.error("Method "+e+" does not exist on jQuery.sticky"):h.unstick.apply(this,arguments)},t(function(){setTimeout(p,0)});var l=t(".page-header").height();t(".edit-btn").sticky({topSpacing:l})}}});